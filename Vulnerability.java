/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/Classes/Class.java to edit this template
 */
package Models;


public class Vulnerability implements Comparable{
    public Cve cve;
    
    public String getCVE_ID() {
        return cve.id ;
    }
    public double getBaseScore() { 
        return cve.metrics.cvssMetricV2.get(0).cvssData.baseScore ;
    }
    public double getImpactScore() {
        return cve.metrics.cvssMetricV2.get(0).impactScore;
    }
    public double getExploitabilityScore() {
        return cve.metrics.cvssMetricV2.get(0).exploitabilityScore;
    }

    @Override
    public int compareTo(Object o) {
    
         Vulnerability obj = (Vulnerability)o ;
         
         
         if(this.getBaseScore()>obj.getBaseScore()){ 
             return 1;
         }
         else if(this.getBaseScore()<obj.getBaseScore()){
             return -1 ;
         }
         else { // baseScore equality 
             
             if(this.getImpactScore()>obj.getImpactScore()){
                 return 1 ;
             }
             else if(this.getImpactScore()<obj.getImpactScore()){
                 return -1 ;
             }
             else { // impactScore equality
                 
                 if(this.getExploitabilityScore()>obj.getExploitabilityScore()){
                     return 1 ;
                 }
                 else if(this.getExploitabilityScore()<obj.getExploitabilityScore()){
                     return -1 ;
                 }
                 else{ // checking id 
                     if(this.getCVE_ID().compareTo(obj.getCVE_ID()) < 0) return 1 ;
                     else if(this.getCVE_ID().compareTo(obj.getCVE_ID()) > 0) return -1 ;
                 }
             }
         }
       // System.out.println(this.getCVE_ID()+" and "+obj.getCVE_ID()+" are equal!");
        return 0 ; 
    }
}
